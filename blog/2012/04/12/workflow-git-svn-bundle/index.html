<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Workflow git svn et git bundle | Au coin d'une table</title><meta name=keywords content="git,svn,bundle,workflow"><meta name=description content="Il y a quelques temps, j’expliquais mon workflow git-svn. J’avais donc mes petites habitudes, tout allait bien. Un jour, le chef vient voir notre petite équipe et désigne deux de mes collègues pour aller chez le client. Le problème survient lorsque l’on connait les restrictions : pas de connexion direct, seul les mails passent et il va falloir faire des modifications en live (ie. chez le client) et bien sûr, on doit rester synchronisé."><meta name=author content="Isammoc"><link rel=canonical href=https://blog.isammoc.net/blog/2012/04/12/workflow-git-svn-bundle/><link href=/assets/css/stylesheet.min.0ef71315edca03ac3fb4b85c2eaba80d9aa9c097f62b53e704ebe8e433907e89.css integrity="sha256-DvcTFe3KA6w/tLhcLquoDZqpwJf2K1PnBOvo5DOQfok=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.isammoc.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.isammoc.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.isammoc.net/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.isammoc.net/apple-touch-icon.png><link rel=mask-icon href=https://blog.isammoc.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><meta property="og:title" content="Workflow git svn et git bundle"><meta property="og:description" content="Il y a quelques temps, j’expliquais mon workflow git-svn. J’avais donc mes petites habitudes, tout allait bien. Un jour, le chef vient voir notre petite équipe et désigne deux de mes collègues pour aller chez le client. Le problème survient lorsque l’on connait les restrictions : pas de connexion direct, seul les mails passent et il va falloir faire des modifications en live (ie. chez le client) et bien sûr, on doit rester synchronisé."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.isammoc.net/blog/2012/04/12/workflow-git-svn-bundle/"><meta property="article:published_time" content="2012-04-12T00:00:00+00:00"><meta property="article:modified_time" content="2012-04-12T00:00:00+00:00"><meta property="og:site_name" content="Au coin d'une table"><meta name=twitter:card content="summary"><meta name=twitter:title content="Workflow git svn et git bundle"><meta name=twitter:description content="Il y a quelques temps, j’expliquais mon workflow git-svn. J’avais donc mes petites habitudes, tout allait bien. Un jour, le chef vient voir notre petite équipe et désigne deux de mes collègues pour aller chez le client. Le problème survient lorsque l’on connait les restrictions : pas de connexion direct, seul les mails passent et il va falloir faire des modifications en live (ie. chez le client) et bien sûr, on doit rester synchronisé."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://blog.isammoc.net/blog/"},{"@type":"ListItem","position":2,"name":"Workflow git svn et git bundle","item":"https://blog.isammoc.net/blog/2012/04/12/workflow-git-svn-bundle/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Workflow git svn et git bundle","name":"Workflow git svn et git bundle","description":"Il y a quelques temps, j’expliquais mon workflow git-svn. J’avais donc mes petites habitudes, tout allait bien. Un jour, le chef vient voir notre petite équipe et désigne deux de …","keywords":["git","svn","bundle","workflow"],"articleBody":"Il y a quelques temps, j’expliquais mon workflow git-svn. J’avais donc mes petites habitudes, tout allait bien. Un jour, le chef vient voir notre petite équipe et désigne deux de mes collègues pour aller chez le client. Le problème survient lorsque l’on connait les restrictions : pas de connexion direct, seul les mails passent et il va falloir faire des modifications en live (ie. chez le client) et bien sûr, on doit rester synchronisé. Heureusement, git est venu à notre secours.\n Préparation Avant que mes deux collègues ne partent, je leur ai fait un petit topo de ce que je vous présente dans cet article.\n Du côté de leur machine, nous avons cloné mon dépôt git :\n $ git clone git://machine/chemin/de/mon/depot   Sur ma machine, j’ai juste taggué la version actuelle de master :\n $ git tag client   Et ils étaient parés à affronter le client en toute sérénité.\n   Chez le client Lorsque mes collègues avaient des choses à faire…​ ils les faisaient. Les seules règles :\n   faire tout travail dans une branche tirée de master\n  ne jamais merger avec master\n   $ git checkout -b fix1 master hack hack hack $ git add . $ git commit   Ils pouvaient donc faire plusieurs tâches différentes (dans des branches différentes), et lorsqu’ils avaient fini, ils devaient m’envoyer un bundle regroupant leurs branches locales.\n $ git bundle create projet-date.bundle ^master fix1 fix2 ...   Cela crée un fichier projet-date.bundle qui contient uniquement les différences entre leur branches et master et non l’historique depuis le début du projet, ni les fichiers complets ; uniquement le patch, ce qui allège considérablement la taille du fichier. Le fichier m’était ensuite transmis par mail. Je leur envoyais en retour un autre bundle contenant les modifications du reste de l’équipe (restant dans nos locaux) ainsi que leur modifications mergées dans master qu’ils intégraient avec :\n $ git fetch projet-date.bundle   Ils pouvaient alors supprimer leurs branches s’ils le désiraient.\n   Dans nos locaux De mon côté, je continuais à travailler normalement (comprendre avec le workflow git-svn) et lorsque je recevais leur bundle :\n $ git bundle verify projet-date.bundle   Cela permet de lister les branches contenues dans le bundle et de vérifier qu’il ne manque pas de données pour pouvoir récupérer les commits. Une fois rassuré, je pouvais rapatrier les branches une à une avec :\n $ git fetch projet-date.bundle fix1:monfix1   Sachant que SVN gère mal les historiques complexes, je rebasais cette nouvelle branche puis envoyais le résultat sur le serveur central.\n $ git checkout monfix1 $ git rebase master $ git checkout master $ git merge monfix1 --ff-only $ git svn rebase $ git svn dcommit   Et de même pour toutes les branches fournies dans le bundle.\n Une fois le serveur à jour avec les dernières modifications, j’empaquetais le dernier état de master dans un bundle :\n $ git bundle create projet-date.bundle ^client master $ git tag -f client   Le fichier créé comporte donc les différences entre le tag client et le master actuel. Le tag client est réactualisé de force pour la prochaine itération.\n Je leur transmettais le nouveau bundle par mail pour qu’ils puissent tester (et corriger si besoin) directement avec l’environnement du client.\n   Conclusion Malgré la contrainte de devoir utiliser SVN comme serveur central de référence et la difficulté de ne pouvoir se contacter que par mails, nous nous en sommes sortis grâce à git qui nous a évité les conflits par patches ou les diff à rallonge. Ce ne fut pas forcément très simple, mais avec les quelques commandes présentées ci-dessus, nous avons pu continuer à travailler le plus proprement possible malgré les conditions.\n   ","wordCount":"596","inLanguage":"en","datePublished":"2012-04-12T00:00:00Z","dateModified":"2012-04-12T00:00:00Z","author":{"@type":"Person","name":"Isammoc"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.isammoc.net/blog/2012/04/12/workflow-git-svn-bundle/"},"publisher":{"@type":"Organization","name":"Au coin d'une table","logo":{"@type":"ImageObject","url":"https://blog.isammoc.net/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://blog.isammoc.net/ accesskey=h title="Au coin d'une table (Alt + H)"><img src=/apple-touch-icon.png alt=logo aria-label=logo height=35>Au coin d'une table</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://blog.isammoc.net/categories/ title=categories><span>categories</span></a></li><li><a href=https://blog.isammoc.net/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Workflow git svn et git bundle</h1><div class=post-meta>April 12, 2012&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Isammoc</div></header><div class=post-content><div class=paragraph><p>Il y a quelques temps, j’expliquais mon <a href=http://blog.isammoc.net/blog/2011/09/25/workflow-git-svn/>workflow git-svn</a>. J’avais donc mes petites habitudes, tout allait bien. Un jour, le chef vient voir notre petite équipe et désigne deux de mes collègues pour aller chez le client. Le problème survient lorsque l’on connait les restrictions : pas de connexion direct, seul les mails passent et il va falloir faire des modifications en live (ie. chez le client) et bien sûr, on doit rester synchronisé. Heureusement, git est venu à notre secours.</p></div><div class=sect1><h2 id=_préparation>Préparation<a hidden class=anchor aria-hidden=true href=#_préparation>#</a></h2><div class=sectionbody><div class=paragraph><p>Avant que mes deux collègues ne partent, je leur ai fait un petit topo de ce que je vous présente dans cet article.</p></div><div class=paragraph><p>Du côté de leur machine, nous avons cloné mon dépôt git :</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git clone git://machine/chemin/de/mon/depot</code></pre></div></div><div class=paragraph><p>Sur ma machine, j’ai juste taggué la version actuelle de master :</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git tag client</code></pre></div></div><div class=paragraph><p>Et ils étaient parés à affronter le client en toute sérénité.</p></div></div></div><div class=sect1><h2 id=_chez_le_client>Chez le client<a hidden class=anchor aria-hidden=true href=#_chez_le_client>#</a></h2><div class=sectionbody><div class=paragraph><p>Lorsque mes collègues avaient des choses à faire…​ ils les faisaient.
Les seules règles :</p></div><div class=ulist><ul><li><p>faire tout travail dans une branche tirée de master</p></li><li><p>ne jamais merger avec master</p></li></ul></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git checkout -b fix1 master
hack hack hack
$ git add .
$ git commit</code></pre></div></div><div class=paragraph><p>Ils pouvaient donc faire plusieurs tâches différentes (dans des branches différentes), et lorsqu’ils avaient fini, ils devaient m’envoyer un bundle regroupant leurs branches locales.</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git bundle create projet-date.bundle ^master fix1 fix2 ...</code></pre></div></div><div class=paragraph><p>Cela crée un fichier <code>projet-date.bundle</code> qui contient uniquement les différences entre leur branches et <code>master</code> et non l’historique depuis le début du projet, ni les fichiers complets ; uniquement le patch, ce qui allège considérablement la taille du fichier.
Le fichier m’était ensuite transmis par mail. Je leur envoyais en retour un autre bundle contenant les modifications du reste de l’équipe (restant dans nos locaux) ainsi que leur modifications mergées dans master qu’ils intégraient avec :</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git fetch projet-date.bundle</code></pre></div></div><div class=paragraph><p>Ils pouvaient alors supprimer leurs branches s’ils le désiraient.</p></div></div></div><div class=sect1><h2 id=_dans_nos_locaux>Dans nos locaux<a hidden class=anchor aria-hidden=true href=#_dans_nos_locaux>#</a></h2><div class=sectionbody><div class=paragraph><p>De mon côté, je continuais à travailler normalement (comprendre avec le <a href=http://blog.isammoc.net/blog/2011/09/25/workflow-git-svn/>workflow git-svn</a>) et lorsque je recevais leur bundle :</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git bundle verify projet-date.bundle</code></pre></div></div><div class=paragraph><p>Cela permet de lister les branches contenues dans le bundle et de vérifier qu’il ne manque pas de données pour pouvoir récupérer les commits. Une fois rassuré, je pouvais rapatrier les branches une à une avec :</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git fetch projet-date.bundle fix1:monfix1</code></pre></div></div><div class=paragraph><p>Sachant que SVN gère mal les historiques complexes, je rebasais cette nouvelle branche puis envoyais le résultat sur le serveur central.</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git checkout monfix1
$ git rebase master
$ git checkout master
$ git merge monfix1 --ff-only
$ git svn rebase
$ git svn dcommit</code></pre></div></div><div class=paragraph><p>Et de même pour toutes les branches fournies dans le bundle.</p></div><div class=paragraph><p>Une fois le serveur à jour avec les dernières modifications, j’empaquetais le dernier état de <code>master</code> dans un bundle :</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>$ git bundle create projet-date.bundle ^client master
$ git tag -f client</code></pre></div></div><div class=paragraph><p>Le fichier créé comporte donc les différences entre le tag <code>client</code> et le <code>master</code> actuel. Le tag <code>client</code> est réactualisé de force pour la prochaine itération.</p></div><div class=paragraph><p>Je leur transmettais le nouveau bundle par mail pour qu’ils puissent tester (et corriger si besoin) directement avec l’environnement du client.</p></div></div></div><div class=sect1><h2 id=_conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#_conclusion>#</a></h2><div class=sectionbody><div class=paragraph><p>Malgré la contrainte de devoir utiliser SVN comme serveur central de référence et la difficulté de ne pouvoir se contacter que par mails,
nous nous en sommes sortis grâce à git qui nous a évité les conflits par patches ou les diff à rallonge.
Ce ne fut pas forcément très simple, mais avec les quelques commandes présentées ci-dessus, nous avons pu continuer à travailler le plus proprement possible malgré les conditions.</p></div></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.isammoc.net/tags/git/>git</a></li><li><a href=https://blog.isammoc.net/tags/svn/>svn</a></li><li><a href=https://blog.isammoc.net/tags/bundle/>bundle</a></li><li><a href=https://blog.isammoc.net/tags/workflow/>workflow</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://blog.isammoc.net/>Au coin d'une table</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.b5c50a006af5240e8b9a820c9517fc939c995c2503cb822fca9c6177c10b9926.js integrity="sha256-tcUKAGr1JA6LmoIMlRf8k5yZXCUDy4Ivypxhd8ELmSY=" onload=hljs.initHighlightingOnLoad();></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>